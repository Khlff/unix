# Задача 3

## Тема: родительские и дочерние процессы, демоны, сигналы

В некоторых Unix первым запущенным пользовательским процессом является `init`, который после своей загрузки запускает остальные необходимые для жизни системы процессы. Требуется написать программу `myinit`, представляющую собой упрощённый вариант `init`, которая запускает другие программы и следит за их состоянием.

### Требования к `myinit`:

- Чтение конфигурационного файла с программами.
- Запуск дочерних процессов.
- Демонизация своего процесса.
- Реагирование на сигнал `SIGHUP`.

---

### Формат конфигурационного файла

Каждая строка файла содержит:
<исполняемый_файл> <stdin_файл> <stdout_файл>

**Пример:**

/bin/sleep 15 /home/user/myinit/in1 /home/user/myinit/out1

---

### Алгоритм работы `myinit`:

1. Меняет текущий каталог на корневой (`/`).
2. Закрывает все файловые дескрипторы.
3. Избавляется от управляющего терминала.
4. Открывает лог-файл в каталоге `/tmp`.
5. Читает конфигурационный файл.
6. Для каждой строки запускает дочерний процесс:
    - Перенаправляет `stdin` и `stdout`.
    - Запускает указанный исполняемый файл с аргументами.

⚠️ Все пути должны быть **абсолютными**, иначе после смены каталога на `/` они станут недействительными.

7. Информация о запущенных процессах записывается в лог.
8. При завершении любого дочернего процесса:
    - Запускается новый аналогичный процесс.
    - В лог пишется причина завершения и факт перезапуска.

---

### Обработка `SIGHUP`:

- Повторно читает конфигурационный файл.
- Завершает все текущие процессы.
- Запускает новые в соответствии с обновлённым конфигом.
- В лог записываются все завершения и старты.

---

### Тестирование (`runme.sh`)

Написать скрипт `runme.sh`, который выполняет следующее:

1. Стартует `myinit` с 3 тестовыми процессами с разными именами.
2. Проверяет через `ps`, что запущено **3 дочерних процесса**.
3. Командой `pkill` завершает **процесс №2**.
4. Через секунду снова проверяет, что запущено **3 дочерних процесса**.
5. Заменяет конфигурационный файл на файл с **одним** дочерним процессом.
6. Посылает сигнал `SIGHUP` процессу `myinit`.
7. Проверяет через `ps`, что запущен **один дочерний процесс**.
8. Проверяет лог-файл:
    - Старт 3 процессов.
    - Завершение и перезапуск процесса №2.
    - Завершение всех 3 процессов.
    - Старт одного нового процесса.

---
